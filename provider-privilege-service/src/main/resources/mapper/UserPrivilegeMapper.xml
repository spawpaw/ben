<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.spawpaw.ben.provider.dao.UserPrivilegeMapper">
    <resultMap id="BaseResultMap" type="com.spawpaw.ben.api.entity.Privilege">
        <id column="id" jdbcType="INTEGER" property="id"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="title" jdbcType="VARCHAR" property="title"/>
        <result column="description" jdbcType="VARCHAR" property="description"/>
    </resultMap>
    <sql id="Base_Column_List">
        id, username, password, create_time
    </sql>

    <select id="selectPrivilegesByGroups" resultType="com.spawpaw.ben.api.entity.Privilege">
        <if test="groups!=null and groups.size>0">
            SELECT
            id,
            `name`,
            title,
            description
            FROM user_group_has_privilege
            LEFT JOIN user_privilege ON user_group_has_privilege.privilege_id = user_privilege.id
            WHERE user_group_has_privilege.group_id IN
            <foreach open="(" close=")" collection="groups" item="listItem" separator=",">
                #{listItem.id}
            </foreach>

        </if>
        <if test="groups==null or groups.size==0">
          SELECT * FROM user_privilege WHERE 1=2;
        </if>

    </select>

</mapper>